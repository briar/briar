sourceSets.configureEach { sourceSet ->
	tasks.named(sourceSet.compileJavaTaskName).configure {
		options.generatedSourceOutputDirectory = file("$buildDir/generated/source/apt/${sourceSet.name}")
	}
}

idea {
	module {
		sourceDirs += file(compileJava.options.generatedSourceOutputDirectory)
		generatedSourceDirs += file(compileJava.options.generatedSourceOutputDirectory)
		testSourceDirs += file(compileTestJava.options.generatedSourceOutputDirectory)
		generatedSourceDirs += file(compileTestJava.options.generatedSourceOutputDirectory)
	}
}
